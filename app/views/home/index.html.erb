<div class="full height image">
  <div class="ui main container">
    <div class="ui information container">
      <h1 class="ui center aligned header">Slyp is disrupting the share button</h1>
      <p>One place to store, share and discover new content with your friends :)</p>
      <div class="ui center aligned basic container">
        <div class="ui huge buttons">
          <button id="beta" class="ui positive button">Beta access</button>
          <div class="or"></div>
          <button id="login" class="ui button">Login</button>
        </div>
      </div>
    </div>
  </div>

  <div class="ui vertical footer segment">
    <div class="ui center aligned container">
      <div class="ui horizontal inverted small divided link list">
        <a class="item">Â© 2016</a>
        <a class="item" href="#">Terms and Conditions</a>
        <a class="item" href="#">Privacy Policy</a>
      </div>
    </div>
  </div>
</div>

<div class="ui modal">
  <div class="ui top attached tabular pointing secondary large menu">
    <a class="ui green active item" data-tab="beta">Request Beta Access</a>
    <a class="ui grey item" data-tab="login">Login</a>
  </div>
  <div class="ui bottom attached active tab segment" data-tab="beta">
    <div class="ui basic center aligned segment">
      <form id="beta-request" class="ui form" action="/users/beta_request" method="post">
        <div class="fields">
          <div class="eight wide required field">
            <label>First Name</label>
            <input type="text" name="first_name" placeholder="First Name">
          </div>
          <div class="eight wide required field">
            <label>Last Name</label>
            <input type="text" name="last_name" placeholder="Last Name">
          </div>
        </div>
        <div class="fields">
          <div class="sixteen wide centered required field">
            <label>Email</label>
            <input  type="email" name="email" placeholder="Enter your email">
          </div>
        </div>
        <div class="ui success message">
          <div class="header">All set</div>
          <p>Hit submit to become part of Slyp Beta!</p>
        </div>
        <div class="ui error message">
          <div class="header">Not quite</div>
          <p>Please fix the remaining errors before you can become part of Slyp Beta</p>
        </div>
        <div class="ui positive submit button">Submit</div>
      </form>
    </div>
  </div>
  <div class="ui bottom attached tab segment" data-tab="login">
    <div class="ui center aligned basic segment">
      <%= link_to user_omniauth_authorize_path(:facebook) do %>
        <button class="ui facebook big button">
          <i class="facebook icon"></i>
         Login with Facebook
        </button>
      <% end %>
      <%= link_to user_omniauth_authorize_path(:google_oauth2) do %>
        <button class="ui google plus big button">
          <i class="google plus icon"></i>
          Login with Google
        </button>
      <% end %>
    </div>
    <div class="ui horizontal divider">
      Or
    </div>
    <%= form_tag session_path(:user), { :class => "ui form" } do %>
      <div class="two fields">
        <div class="field">
          <div class="ui center aligned container">
            <div class="ui left icon input">
              <i class="user icon"></i>
                <%= text_field_tag "user[email]", nil, name: "email", :placeholder => "E-mail address", :style => "cursor: auto; background-attachment: scroll; background-size: 16px 18px; background-position: 98% 50%; background-repeat: no-repeat;" %>
            </div>
          </div>
        </div>
        <div class="field">
          <div class="ui center aligned container">
            <div class="ui left icon input">
              <i class="lock icon"></i>
              <%= password_field_tag "user[password]", nil, name: "password", :placeholder => "Password", :style => "cursor: auto; background-attachment: scroll; background-size: 16px 18px; background-position: 98% 50%; background-repeat: no-repeat;" %>
            </div>
          </div>
        </div>
      </div>
      <button class="ui fluid submit button">Login</button>
      </div>
    <% end %>
  </div>
</div>


<script type="text/javascript">
  $('.tabular.menu .item').tab();

  $('#beta').click(function(){
    $('.tabular.menu .item').tab('change tab', 'beta')
    $('.ui.modal').modal('show');
  });

  $('#login').click(function(){
    $('.tabular.menu .item').tab('change tab', 'login')
    $('.ui.modal').modal('show');
  });

  var $form = $('#beta-request');
  var rules = {
    on: 'blur',
    inline: true,
    fields: {
      email: {
        identifier  : 'email',
        rules: [
          {
            type   : 'email',
            prompt : 'Please enter a valid e-mail'
          }
        ]
      },
      firstName: {
        identifier : 'first_name',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please provide us with your first name'
          }
        ]
      },
      lastName: {
        identifier : 'last_name',
        rules: [
          {
            type   : 'empty',
            prompt : 'Please provide us with your last name'
          }
        ]
      }
    }
  }

  var settings = {
    onSuccess: function(event, fields){
      $form.removeClass('success');
    },
    onFailure: function(formErrors, fields){
      $form.removeClass('error');
    }
  }

  $form.form(rules, settings);

  $form.submit(function(){
    $.post($(this).attr('action'), $(this).serialize(), function(response){
      $form.find('.ui.success.message p').text('You are #' +
        response.priority + ' on our waitlist. An email is on it\'s way to you :)');
      $form.removeClass('error');
      $form.addClass('success');
    },'json')
    .fail(function(err){
      $form.find('.ui.error.message p').text(err.responseJSON.error[0]);
      $form.removeClass('success');
      $form.addClass('error')
    });
    return false;
  });
</script>
